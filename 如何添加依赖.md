# 如何添加依赖到仓库

## 当前问题

构建显示成功，但"上传构建产物"被跳过，因为没有生成任何输出文件。

**原因**：项目缺少必需的依赖（CrossRoads, Core, libs）

## 解决方案

### 方法 1: 直接添加依赖（如果文件不太大）

```powershell
# 1. 确保在正确的目录
cd I:\wd1\wd02

# 2. 添加依赖
git add ../Cryptic/CrossRoads
git add ../Cryptic/Core
git add ../libs

# 3. 提交
git commit -m "Add required dependencies: CrossRoads, Core, libs"

# 4. 推送
git push
```

### 方法 2: 使用 Git LFS（推荐，适用于大文件）

如果依赖文件很大（>100MB），使用 Git LFS：

```powershell
# 1. 安装 Git LFS（如果还没安装）
git lfs install

# 2. 配置跟踪大文件
git lfs track "*.dll"
git lfs track "*.lib"
git lfs track "*.pdb"
git lfs track "*.exe"
git lfs track "*.obj"

# 3. 添加 .gitattributes
git add .gitattributes

# 4. 添加依赖
cd I:\wd1\wd02
git add ../Cryptic/CrossRoads
git add ../Cryptic/Core
git add ../libs

# 5. 提交
git commit -m "Add dependencies with Git LFS"

# 6. 推送
git push
```

### 方法 3: 检查依赖大小

在添加之前，先检查依赖的大小：

```powershell
cd I:\wd1

# 检查 CrossRoads 大小
$size = (Get-ChildItem "Cryptic\CrossRoads" -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum
Write-Host "CrossRoads size: $([math]::Round($size/1MB,2)) MB"

# 检查 Core 大小
$size = (Get-ChildItem "Cryptic\Core" -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum
Write-Host "Core size: $([math]::Round($size/1MB,2)) MB"

# 检查 libs 大小（如果存在）
if (Test-Path "libs") {
    $size = (Get-ChildItem "libs" -Recurse -File -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum
    Write-Host "libs size: $([math]::Round($size/1MB,2)) MB"
}
```

**GitHub 限制**：
- 单个文件最大 100MB
- 仓库推荐大小 < 1GB
- 如果超过，使用 Git LFS

## 验证

添加依赖后：

1. **触发新的构建**：
   - 访问：https://github.com/yanlongyang806-cyber/wd02/actions
   - 点击 "Run workflow" 手动触发

2. **检查构建日志**：
   - 查看 "检查依赖项" 步骤
   - 应该显示 "OK: CrossRoads found" 和 "OK: Core found"

3. **检查输出文件**：
   - 如果构建成功，应该能找到 .exe 文件
   - "上传构建产物" 步骤应该成功

## 如果依赖太大

如果依赖文件太大无法添加到 GitHub：

1. **使用 Git LFS**（如上）
2. **只添加必要的文件**（头文件和库文件，排除 .pdb, .obj 等）
3. **使用子模块**（如果依赖在单独的仓库中）
4. **使用自托管 Runner**（在本地机器上运行 GitHub Actions）

## 下一步

1. 检查依赖大小
2. 选择合适的添加方法
3. 添加依赖到仓库
4. 触发新的构建
5. 验证输出文件

